# Canvas Mode

SimpleKit's **canvas mode** exposes a lightweight event loop for drawing directly on a single HTML canvas.  This mode is intended for quick experiments or projects that need only basic event handling without the full widget system.

## Starting the toolkit

1. Ensure the HTML file running SimpleKit contains only a single `script` tag in the `<body>` and no extra stylesheets.  `startSimpleKit` checks these conditions and creates the canvas element for you.
2. Import the module:

```ts
import {
  startSimpleKit,
  setSKDrawCallback,
  setSKEventListener,
  setSKAnimationCallback,
  addSKEventTranslator,
  skTime,
} from "simplekit/src/canvas-mode";
```
3. Call `startSimpleKit()` once during startup.  The function returns the canvas size or `false` if the HTML page does not meet the requirements.

```ts
const canvasInfo = startSimpleKit();
if (!canvasInfo) throw new Error("SimpleKit failed to start");
```

## Drawing and animation

Use `setSKDrawCallback` to supply a function that draws to the canvas each frame.  The callback receives the `CanvasRenderingContext2D` used by the toolkit.  For animations, register a function with `setSKAnimationCallback`.  The animation callback receives the current timestamp (available globally as `skTime`).

```ts
setSKDrawCallback((gc) => {
  gc.clearRect(0, 0, gc.canvas.width, gc.canvas.height);
  gc.fillStyle = "tomato";
  gc.fillRect(50, 50, 100, 100);
});

setSKAnimationCallback((time) => {
  // update positions or physics here
});
```

## Receiving events

The canvas mode translates low‑level browser events into `SKEvent` objects.  Register a listener with `setSKEventListener` to receive all translated events:

```ts
setSKEventListener((e) => {
  if (e.type === "click") console.log("canvas clicked at", e.x, e.y);
});
```

### Event translators

SimpleKit includes translators for fundamental events (`mousedown`, `mouseup`, `mousemove`, `keydown`, `keyup`, and `resize`) as well as higher level ones:

- `click` – generated by `clickTranslator`
- `dblclick` – generated by `dblclickTranslator`
- `dragstart`, `drag`, `dragend` – generated by `dragTranslator`

You may provide your own translators using `addSKEventTranslator(translator)` where a translator is an object with an `update(fundamentalEvent)` method returning an `SKEvent`.

## Typical flow

1. Call `startSimpleKit`.
2. Register optional translators with `addSKEventTranslator`.
3. Provide drawing, animation and event callbacks.
4. SimpleKit runs an internal loop that translates events, dispatches them to your listener, then calls your animation and draw callbacks every frame.

Canvas mode does not handle any widgets or layout; you are free to draw whatever you like to the canvas using the provided graphics context.